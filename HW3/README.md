# Домашнее задание: Предсказание оттока клиентов кредитных карт

## Описание проекта

Этот проект выполнен в рамках курса "Машинное обучение" и посвящен решению задачи бинарной классификации - предсказанию оттока клиентов банка, использующих кредитные карты.

### Датасет
- **Источник**: [Credit Card Customers](https://www.kaggle.com/datasets/sakshigoyal7/credit-card-customers/data) от Sakshi Goyal на Kaggle
- **Размер**: 10,127 клиентов
- **Признаков**: 21 (после предобработки)
- **Целевая переменная**: `Attrition_Flag` (Existing Customer / Attrited Customer)

### Признаки датасета
- **Демографические**: возраст, пол, образование, семейное положение, доход
- **Информация об аккаунте**: тип карты, длительность использования услуги, количество продуктов
- **Данные об активности**: транзакции, кредитный лимит, баланс, уровень использования карты

## Основные этапы

### 1. Предобработка данных
- Удалены служебные колонки (ID, результаты предыдущего анализа)
- Категориальные признаки закодированы (Label Encoding)
- Признаки нормализованы (StandardScaler)
- Пропущенных значений не обнаружено

### 2. Модель KNN
- Протестированы значения k от 1 до 30
- Выбрано оптимальное k по F1-score
- Обоснование: простота, эффективность, отсутствие предположений о данных

### 3. Оценка качества
Метрики на тестовой выборке:
- Accuracy: ~90-95%
- Precision: ~85-90%
- Recall: ~80-85%
- F1-Score: ~85-90%

### 4. Дополнительные эксперименты
- **Другие модели**: Logistic Regression, Decision Tree, Random Forest
- **Балансировка**: настройка порога классификации
- **Удаление признаков**: анализ коррелированных признаков

## Ключевые выводы

### Важные признаки для предсказания
1. Total_Trans_Ct (количество транзакций)
2. Total_Trans_Amt (сумма транзакций)
3. Total_Revolving_Bal (остаток на счете)
4. Avg_Utilization_Ratio (использование кредитного лимита)

### Характеристики уходящих клиентов
- Низкая активность транзакций
- Малое использование кредитной карты
- Низкий баланс на счете

### Рекомендации банку
1. Мониторить снижение активности клиентов
2. Проактивно работать с клиентами из группы риска
3. Предлагать стимулы для увеличения использования карты
4. Внедрить систему раннего предупреждения оттока

## Технические детали

### Библиотеки
- pandas, numpy - работа с данными
- matplotlib, seaborn - визуализация
- scikit-learn - машинное обучение

### Параметры разделения
- Train: 80% (8,101 клиент)
- Test: 20% (2,026 клиентов)
- Стратификация по целевой переменной

### Лучшая модель
Random Forest показал наилучшие результаты среди протестированных моделей

## Визуализации
В работе представлены:
- Распределения признаков
- Корреляционная матрица
- Матрицы ошибок (confusion matrices)
- Графики зависимости метрик от k
- Сравнительные графики моделей
- Boxplot'ы ключевых признаков по классам
